<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/main_layout}">
    <head>
        <title>Recon Type Setup</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

    </head>
    <body>
        <div layout:fragment="pageStyle" th:remove="tag">
            <link th:href="@{/assets/plugins/datatables/jquery.dataTables.min.css}" rel="stylesheet" type="text/css"/>
            <link th:href="@{/assets/plugins/datatables/buttons.bootstrap.min.css}" rel="stylesheet" type="text/css"/>
            <link th:href="@{/assets/plugins/datatables/responsive.bootstrap.min.css}" rel="stylesheet" type="text/css"/>
            <link th:href="@{/assets/plugins/datatables/scroller.bootstrap.min.css}" rel="stylesheet" type="text/css"/>
            <link th:href="@{/assets/plugins/datatables/dataTables.colVis.css}" rel="stylesheet" type="text/css"/>
            <link th:href="@{/assets/plugins/datatables/dataTables.bootstrap.min.css}" rel="stylesheet" type="text/css"/>
            <link th:href="@{/assets/plugins/datatables/fixedColumns.dataTables.min.css}" rel="stylesheet" type="text/css"/>
            <link th:href="@{/assets/plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css}" rel="stylesheet">
        </div>
        <div class="container-fluid" layout:fragment="contents">
            <div class="panel panel-default panel-fill" id="tabContentsss"><div class="panel-heading"> <h4 class="panel-title">RECONCILIATION SETUP</h4></div>
                <div class="panel-body">
                    <div id="components" hidden=""></div>
                    <div id="reconTypeForm" hidden="">
                        <h2>Add New Recon Type</h2>
                        <hr/>
                        <form role="form" name="getReconDashboard">
                            <div class="row">
                                <div class="form-group col-md-4">
                                    <label for="Name" style="margin-left: 1% ! important;">Recon Name ( eg. BANK 2 WALLET)</label>
                                    <input name="txnType" class="form-control form-control-inline input-txndatemedium default-date-picker"  id="datepicker-autoclose" data-date-format="yyyy-mm-dd" type="text"  autocomplete="off"/>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="Name" style="margin-left: 1% ! important;">Recon Code( eg. B2C )</label>
                                    <input name="ttype" class="form-control form-control-inline input-txndatemedium default-date-picker"  id="datepicker-autoclose" data-date-format="yyyy-mm-dd" type="text"  autocomplete="off"/>
                                </div>
                                <div class="form-group col-md-4" >
                                    <button type="submit" class="btn btn-primary" style="margin: 7%">Submit</button>
                                </div>
                            </div>

                        </form>
                    </div>
                    <div class="row" id="loading" hidden=""> 
                        <img th:src="@{/assets/images/please_wait.gif}" alt="please wait"/>
                    </div>
                    <div class="row"> <a class="btn btn-primary pull-right" id="addReconType">New Recon Type</a></div>
                    <br/>
                    <div class="row" >
                        <table  class="table table-striped table-bordered"  style="width: 100%; font-size: 11px !important;">
                            <thead>
                                <tr>
                                    <th>S/N</th>
                                    <th>Recon Name</th>
                                    <th>Recon Code</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="types,i:${reconTypes}">
                                    <td th:text="${i.index +1}"></td>
                                    <td th:text="${types.name}"></td>
                                    <td th:text="${types.code}"></td>
                                    <td><a class="btn btn-default">Edit</a> | <a class="btn btn-default" th:onclick="'javascript:reconComponents('+${types.id}+')'">Recon Components</a> | </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!--                    </div>
                            </div>-->
        </div>
        <!--</div>  container -->

        <!--</body>-->
        <div layout:fragment="pageScript" th:remove="tag">
            <script th:src="@{/assets/plugins/datatables/jquery.dataTables.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/dataTables.bootstrap.js}"></script>
            <script th:src="@{/assets/plugins/datatables/dataTables.buttons.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/buttons.bootstrap.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/jszip.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/pdfmake.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/vfs_fonts.js}"></script>
            <script th:src="@{/assets/plugins/datatables/buttons.html5.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/buttons.print.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/dataTables.keyTable.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/dataTables.responsive.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/responsive.bootstrap.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/dataTables.scroller.min.js}"></script>
            <script th:src="@{/assets/plugins/datatables/dataTables.colVis.js}"></script>
            <script th:src="@{/assets/plugins/datatables/dataTables.fixedColumns.min.js}"></script>
            <!-- init -->
            <script th:src="@{/assets/pages/jquery.datatables.init.js}"></script>
            <!-- App Js -->
            <script th:src="@{/assets/js/jquery.app.js}"></script>
            <script th:src="@{/assets/plugins/select2v4/select2.min.js}"></script>
            <script type="text/javascript">
                $(document).ready(function () {
                    //submit the roles
                    $('button[type=submit]').click(function (e) {
                        e.preventDefault();
                        alert('melleji');
                        $('#loading').show();
                        var txnType = $("input[name='txnType']").val();
                        var ttype = $("input[name='ttype']").val();
                        $.ajax({
                            url: "/saveReconType",
                            type: 'GET',
                            data: {txnType: txnType, ttype: ttype},
                            dataType: "json",
                            success: function (res) {
                                $('.error').html('');
                                if (res.validated) {
                                    $('#loading').hide();
                                    var i = 0;
                                    location.reload();
                                } else {
                                    $('#preloader2').hide();
                                    $.each(res.errorMessages, function (key, value) {
                                        $('#loading').hide();
                                        $('Select[name=' + key + ']').after('<span class="error" style="color:red">' + value + '</span>');
                                        $('input[name=' + key + ']').after('<span class="error" style="color:red">' + value + '</span>');
                                    });
                                }
                            }
                        });
                    });
                    $('#addReconType').click(function () {
                        $('#reconTypeForm').toggle('slide');
                        $('#addReconType').hide();
                    });
                });
                function  reconComponents(id) {
                    $('#addReconType').hide();

                    $.ajax({
                        url: "/reconComponents",
                        data: {type_id: id},
                        type: 'GET',
                        success: function (res) {
                            $("#components").toggle('slide').html(res).return;

                        }
                    });
                }
            </script>
        </div>

</html>
