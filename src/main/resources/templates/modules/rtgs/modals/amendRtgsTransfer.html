<div layout:fragment="pageStyle" th:remove="tag">
    <style>
        #loading {
            background: url('/assets/images/ajax-loader.gif') no-repeat center center;
            position: absolute;
            top: 0;
            left: 0;
            height: 92%;
            width: 100%;
            z-index: 9999999;
        }
    </style>
</div>
<div class="panel panel-default panel-fill">
    <div class="panel-heading" style="background-color: #04ab18 ! important; "> <h3 class="panel-title" style="color: #ffffff !important;" th:text="${pageTitle}"></h3>
    </div>
    <div class="panel-body">

        <div  id="loading"> </div>
        <div class="row" id="rtgsPayments">
            <div class="col-md-12" id="successFlag"></div>
            <div class="col-md-12" id="rtgsTransferFormDiv">
                <div id="errorMessage"></div>
                <form class="form-horizontal" role="form" id="ammendRTGSTransaction">
                    <table  class="table table-striped table-bordered"  style="width: 100%; font-size: 8.5px !important;">
                        <tbody th:each="txn:${transaction}">
                            <tr>
                                <td>Sender Account</td>
                                <td><input hidden="" name="reference" th:value="${txn.reference}"/>
                                    <input hidden="" name="cbs_status" th:value="${txn.cbs_status}"/>
                                    <input type="text" name="senderAccount" th:value="${txn.sourceAcct}" class="form-control form-control-sm" autocomplete="off" style="font-size: 10px !important;" placeholder="Sender Account No." id="senderAccount"><button type="button" class="btn btn-primary btn-submit" style="font-size: 9px !important;" onclick="getAccountDetails()">Query Details</button></td>
                                <td>Sender Name</td>
                                <td><input type="text" name="senderName" id="actNM" th:value="${txn.sender_name}" autocomplete="off" readonly="" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Sender Name"></td>
                            </tr>
                            <tr>
                                <td>Amount to Transfer<h5 id="availableBalance" style="color: red;    font-size: 9px;"></h5></td>
                                <td><input type="text" name="amount" readonly="" class="form-control form-control-sm" th:value="${txn.amount}" autocomplete="off" style="font-size: 10px !important;" placeholder="Amount"></td>
                                <td>Sending Currency</td>
                                <td>
                                    <select class="form-control col-sm-12 select2" id="currency" name="currency" style="font-size: 10px !important;">
                                        <option value="">Select Currency</option>
                                        <option value="TZS">TZS</option>
                                        <option value="USD">USD</option>
                                        <option value="EUR">EURO</option>
                                         <option value="ZAR">south africa Rand</option>
                                    </select>                        
                                </td>

                            </tr>
                            <tr>
                                <td>Beneficiary Account</td>
                                <td><input type="text" name="beneficiaryAccount" th:value="${txn.destinationAcct}" autocomplete="off" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Beneficiary Account"></td>
                                <td>Beneficiary Name</td>
                                <td><input type="text" name="beneficiaryName" th:value="${txn.beneficiaryName}" class="form-control form-control-sm" autocomplete="off" style="font-size: 10px !important;" placeholder="Beneficiary Name"></td>
                            </tr>
                            <tr>
                                <td>Beneficiary Bank</td>
                                <td>
                                    <select class="form-control col-sm-12 select2" id="destinationBank" name="beneficiaryBIC"  style="font-size: 10px !important;">
                                        <option value="">Select destination Bank</option>
                                        <option th:each="bank: ${banks}" th:value="${bank.swift_code+'=='+bank.identifier}" th:text="${bank.name+'['+bank.swift_code+']'}"> ATM  </option>
                                    </select>  
                                    <div id="intermediary">

                                    </div>
                                </td>
                                <td>Sender Address</td>
                                <td><input type="text" readonly="" th:value="${txn.sender_address}" id="customerAddress" name="senderAddress" autocomplete="off" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Sender Address"></td>
                            </tr>
                            <tr>
                                <td>Beneficiary Contact</td>
                                <td><input type="text" name="beneficiaryContact"  th:value="${txn.beneficiary_contact}" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Beneficiary Contact"></td>
                                <td>Sender Phone</td>
                                <td><input type="text" name="senderPhone" th:value="${txn.sender_phone}" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Sender Phone"></td>
                            </tr>
                            <tr>
                                <td>Payment Purpose</td>
                                <td><textarea name="description" class="form-control form-control-sm" th:text="${txn.purpose}"  style="font-size: 10px !important;" placeholder="Purpose of Payment"></textarea></td>
                                <td>Supporting Document</td>
                                <td><div id="supportingDocument"><input type="file" name="supportingDoc" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Supporting Document"> <button class="btn btn-primary" id="addField"><span style="font-size:16px; font-weight:bold;">+ </span></button></div></td>
                            </tr>
                        </tbody>
                    </table>
                    <button type="button" class="btn btn-primary ammend-rtgs-payments">Re-Submit</button>
                </form>
            </div>
        </div>
        <!--<div class="form-group col-md-9">-->
        <div class="row"></div>
        <div class="row">
        </div>
    </div>
</div>
<div class="row" id="preloader333" hidden=""> 
    <img th:src="@{/assets/images/please_wait.gif}" alt="please wait"/>
</div>
<div layout:fragment="pageScript" th:remove="tag">
    <script th:src="@{/assets/scripts/teller.js}"></script>
</div>
<script>
    $(document).ready(function () {
        $("#loading").hide();
        $('.select2').select2();
//add the number of files to be attached
        var max_fields = 4;
        var wrapper = $("#supportingDocument");
        var add_button = $("#addField");

        var x = 1;
        $(add_button).click(function (e) {
            e.preventDefault();
            if (x < max_fields) {
                x++;
                $(wrapper).append('<input type="file" name="supportingDoc" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Supporting Document">'); //add input box
            } else {
                alert('You Reached the limits');
            }
        });

        $(wrapper).on("click", ".delete", function (e) {
            e.preventDefault();
            $(this).parent('div').remove();
            x--;
        });
        $('#intermediary').html("");
        $("#destinationBank").on('change', function () {
            var benBic = $("select[name='beneficiaryBIC']").val();
            var identifier = benBic.split('==');
            if (identifier[1] === 'INTERNATIONAL') {
                /*
                 * ADD AN INPUT FOR INTERMEDIARY SWIFT CODE
                 */
                $('#intermediary').append('<input type="text" id="intermediaryBank" name="intermediaryBank" autocomplete="off" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Intermediary Bank Swift Code (IF APPLICABLE)">');

            }
        });
    });
</script>





