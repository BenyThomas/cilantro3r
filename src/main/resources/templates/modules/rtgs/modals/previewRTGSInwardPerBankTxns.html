<div layout:fragment="pageStyle" th:remove="tag">
    <style>
        #loading {
            background: url('/assets/images/ajax-loader.gif') no-repeat center center;
            position: absolute;
            top: 0;
            left: 0;
            height: 92%;
            width: 100%;
            z-index: 9999999;
        };
        #rtgsTxnOnWorkFlow{
            table-layout: fixed !important;
            word-wrap:break-word;
        }
    </style>
    <link th:href="@{/assets/plugins/datatables/jquery.dataTables.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/assets/plugins/datatables/buttons.bootstrap.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/assets/plugins/datatables/responsive.bootstrap.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/assets/plugins/datatables/scroller.bootstrap.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/assets/plugins/datatables/dataTables.colVis.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/assets/plugins/datatables/dataTables.bootstrap.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/assets/plugins/datatables/fixedColumns.dataTables.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/assets/plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css}" rel="stylesheet">
</div>
<div class="row">
    <div class="panel panel-default panel-fill" id="tabContentsss"><div class="panel-heading"> <h4 class="panel-title" th:text="${pageTitle}"></h4></div>
        <div class="panel-body">
            <div class="form-group col-md-12" th:if="${isActionAllowed}" id="actionProcessed">
                <button id="replayTransaction" class="btn btn-primary pull-right col-md-3"  onclick="replayRTGSToCoreBanking()" style="background-color: #989a25 !important;border: 1px solid #989a25 !important;border-radius: 41px !important;">Replay Transaction</button>
                <button id="returnTransaction" onclick="returnInwardEftTransactions()"  class="btn btn-primary pull-right col-md-2" style="    background-color: #0a5b94  !important;border: 1px solid #ffffff  !important;    border-radius: 41px !important;">Return Transactions</button>
            </div>
            <div id="successFlag">
            </div>
            <div class="row" id="content"></div>
            <div class="row" ></div>
            <div  id="loading" hidden=""> </div>
            <input hidden="" name="senderBic" th:value="${senderBic}">
            <input hidden="" name="txnStatus" th:value="${txnStatus}">
            <input hidden="" name="fromDate" th:value="${fromDate}">
            <input hidden="" name="toDate" th:value="${toDate}">

            <div class="row">
                <table id="inwardRTGSBankSuccessSummary" class="display nowrap table table-striped table-bordered" style="width: 80%; font-size: 7.5px !important;">
                    <thead>
                        <tr>
                            <th>S/N</th>
                            <th>Txn Reference</th>
                            <th>messageType</th>
                            <th>Sender Account</th>
                            <th>Sender Name</th>
                            <th>Beneficiary Account</th>
                            <th>Beneficiary Name</th>
                            <th>Amount</th>
                            <th>Currency</th>
                            <th>Description</th>
                            <th>Status</th>
                            <th>Response Code</th>
                            <th>Message</th>
                            <th><input type="button" class="btn btn-primary"  onclick='selectAll()' value="Tick All"><input type="button" class="btn btn-primary" onclick='UnSelectAll()' value="UnTick"></th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
                <!--</form>-->
            </div>
        </div>
    </div>
</div>
<div layout:fragment="pageScript" th:remove="tag">
    <script th:src="@{/assets/plugins/datatables/jquery.dataTables.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.bootstrap.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.buttons.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/buttons.bootstrap.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/jszip.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/pdfmake.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/vfs_fonts.js}"></script>
    <script th:src="@{/assets/plugins/datatables/buttons.html5.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/buttons.print.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.keyTable.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.responsive.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/responsive.bootstrap.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.scroller.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.colVis.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.fixedColumns.min.js}"></script>
    <!-- init -->
    <script th:src="@{/assets/pages/jquery.datatables.init.js}"></script>
    <!-- App Js -->
    <script th:src="@{/assets/js/jquery.app.js}"></script>
    <script th:src="@{/assets/plugins/select2v4/select2.min.js}"></script>
    <script th:src="@{/assets/scripts/teller.js}"></script>
    <script th:src="@{/assets/scripts/eft.js}"></script>
    <script>
        $(document).ready(function () {
            $("#loading").hide();
            $("#select2").select2();
            $('.authorize-payments').attr('disabled', 'disabled');
            $("#mno").on('change', function () {
                $('#inwardEFTBankSuccessSummary').DataTable().ajax.reload();
            });
            var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");
            var b = 1;
            var i = 0;
            var senderBic2 = $("input[name='senderBic']").val();
            var table = $('#inwardRTGSBankSuccessSummary').DataTable({
                dom: 'Blfrtip',
                lengthChange: true,
                scrollCollapse: true,
                scrollY: "700px",
                scrollX: true,
                pageLength: 10,
                lengthMenu: [
                    [5, 10, 25, 50, 100, 500, -1],
                    [5, 10, 25, 50, 100, 500, 'Show all']
                ],
                responsive: false,
                processing: true,
                serverSide: true,
                serverMethod: 'post',
                order: [1, "desc"],
                ajax: {
                    'url': '/getRTGSInwardTransactionsPerBank',
                    'beforeSend': function (request) {
                        request.setRequestHeader(header, token);
                    },
                    "data": function (d) {
                        return $.extend({}, d, {
                            "senderBic": $("input[name='senderBic']").val(),
                            "txnStatus": $("input[name='txnStatus']").val(),
                            "fromDate": $("input[name='fromDate']").val(),
                            "toDate": $("input[name='toDate']").val()
                        });
                    }
                },
                "columns": [
                    {"data": "reference"},
                    {"data": 'reference',
                        "orderable": false,
                        "searchable": false,
                        "width": "25%",
                        "render": function (data, type, row, meta) {
                            return '<a href="/downloadTransferAdvice?senderBank=' + senderBic2 + '&senderReference=' + row.reference + '&receiverBank=' + row.beneficiaryBIC + '">' + row.reference + '</a>';
                        }},
                    {"data": "message_type"},
                    {"data": "sourceAcct"},
                    {"data": "sender_name"},
                    {"data": "destinationAcct"},
                    {"data": "beneficiaryName"},
                    {"data": 'amount',
                        "render": function (data) {
                            var amount = addCommas(data);
                            return amount;
                        }},
                    {"data": "currency"},
                    {"data": "purpose"},
                    {"data": 'cbs_status'},
                    {"data": 'response_code'},
                    {"data": 'message'},
                    {"data": 'reference',
                        "orderable": false,
                        "searchable": false,
                        "width": "25%",
                        "render": function (data, type, row, meta) {
//                     authorizePayment.png      a = '<a type="button" href="/downloadSupportingDoc?reference=' + row.reference + '"><button type="button"><img src="/assets/images/supportingDoc.png" style="width:20px;" title="Download Supporting Document"></button></a>
//                            a = '<button type="button" onclick="previewEftBulkPayments(\'' + row.batch_reference + '\',\'' + row.totalAmount + '\')"><img src="/assets/images/previewSwift.png" style="width:20px;" title="Preview swift Message"></button>';
                            if (row.cbs_status != 'C') {
                                a = '<button type="button" onclick="ammendEftInwardTransaction(\'' + row.reference + '\',\'' + row.amount + '\')"><img src="/assets/images/amendment.png" style="width:20px;" title="Ammend Eft Inward Transaction"></button>';
                                a += '<button><input type="checkbox" style="margin-top:10%" id="' + row.reference + '==' + row.sourceAcct + '==' + row.destinationAcct + '==' + row.amount + '" name="txndetails" /> ';
                            } else {
                                a = '<button type="button" onclick="printEFTAdvice(\'' + row.reference + '\',\'' + row.amount + '\')"><img src="/assets/images/accepted.png" style="width:20px;" title="Print EFT Advice"></button>';
                            }
                            return a;
                        }}
                ], aoColumnDefs: [
                    {
                        bSortable: false,
                        aTargets: [-1],
                    }
                ], columnDefs: [
                    {width: 1000, targets: 14}
                ],
//                fixedColumns: true,
                buttons: [{
                        extend: "copy",
                        title: 'Authorize RTGS Remittance Transactions',
                        className: "btn-sm"
                    }, {
                        extend: "csv",
                        title: 'Authorize RTGS Remittance  Transactions',
                        className: "btn-sm"
                    }, {
                        extend: "excel",
                        title: 'Authorize RTGS Remittance  Transactions',
                        className: "btn-sm"
                    }, {
                        extend: "pdf",
                        title: 'Authorize RTGS Remittance  Transactions',
                        className: "btn-sm"
                    }, {
                        extend: "print",
                        title: 'Authorize RTGS Remittance  Transactions',
                        className: "btn-sm"
                    }],
                "preDrawCallback": function (settings) {
                    if ($("select[name='mno']").val() == '') {
                        return false;
                    }
                }
            });
            table.on('order.dt search.dt', function () {
                table.column(0, {search: 'applied', order: 'applied'}).nodes().each(function (cell, i) {
                    cell.innerHTML = i + 1;
                });
            }).draw();
        });
        function reloadDatatable() {
            $('#inwardEFTBankSuccessSummary').DataTable().ajax.reload();
        }
        /*
         * PROCESS REPLAY TO INTENDED ACCOUNT ON FAILURE OF RTGS INCOMING
         */
        function replayRTGSToCoreBanking() {
            $("#ambigousBtn").hide();
            var post_arr = [];
            var hiddenData = "";
            var references = "'0'";
            var accounts = "'0'";

            // Collect selected rows
            $('#inwardRTGSBankSuccessSummary input[type=checkbox]').each(function () {
                if (jQuery(this).is(":checked")) {
                    var id = this.id;
                    var datas = id.split('==');
                    references += ",'" + datas[0] + "'";
                    accounts += ",'" + datas[1] + "'";
                    hiddenData += '<input type="text" name="txnid" value="' + datas[0] + '" hidden/>';
                    post_arr.push({ txnid: id });
                }
            });

            if (post_arr.length === 0) {
                $("#ambigousBtn").show();
                alert('No data selected');
                return;
            }

            // Load exception accounts first, then render the form
            $.ajax({
                url: "/getTransferIncomingDestAcctExceptions",
                type: 'GET',
                success: function (response) {
                    var options = "";
                    if (response !== 1 && response) {
                        for (var key in response) {
                            options += '<option value="' + response[key].account + '==' + response[key].accountType + '">' + response[key].accountName + '</option>';
                        }
                    }

                    $("#actionProcessed").hide();

                    const formHtml = `
            <div class="row" style="margin-left:10px !important; margin-right:10px !important;">
              <form role="form" name="replayRTGSTransactionForm" id="replayRTGSTransactionForm" enctype="multipart/form-data">
                <table class="table table-striped table-bordered" style="width:100%; font-size:10.5px !important;">
                  <tbody>
                    <!-- REPLAY TO -->
                    <tr id="rowReplayTo">
                      <td>REPLAY TO</td>
                      <td>
                        <select class="form-control" id="replayOption" name="replayOption" required>
                          <option value="off" selected>--SELECT RETURN OPTION--</option>
                          <option value="5==5">REPLAY TO INTENDED</option>
                          <option value="7==7">RETURN THE TRANSACTION</option>
                          <option value="6==6">BRANCH TRANSFER AWAITING</option>
                          <option value="10">MTN-STAWI BOND</option>
                          ${options}
                        </select>
                      </td>
                    </tr>

                    <!-- REPLAY REASON -->
                    <tr id="rowReason">
                      <td>REPLAY REASON</td>
                      <td>
                        <textarea id="reason" name="reason" placeholder="Replay reason of failure. why are you processing manually?" rows="2" cols="120" class="form-control"></textarea>
                      </td>
                    </tr>

                    <!-- CDS NUMBER + VERIFY (STAWI ONLY) -->
                    <tr id="rowCds" style="display:none;">
                      <td>CDS Number</td>
                      <td>
                        <div class="input-group" style="max-width:480px;">
                          <input id="cdsNumber" name="cdsNumber" class="form-control" placeholder="e.g. 730019"/>
                          <span class="input-group-btn">
                            <button type="button" class="btn btn-warning" id="verifyCdsBtn">Verify</button>
                          </span>
                        </div>
                        <div id="lookupResult" style="margin-top:8px;"></div>
                      </td>
                    </tr>

                    <!-- BRANCH CODE (hide for STAWI) -->
                    <tr id="rowBranchCode">
                      <td>Branch Code</td>
                      <td>
                        <input id="branchCode" class="form-control" name="branchCode" placeholder="Branch Number [for replay to transfer awaiting postings]">
                      </td>
                    </tr>

                    <!-- MODIFY DESTINATION (hide for STAWI) -->
                    <tr id="rowModDest">
                      <td>Modify Destination (Optional)</td>
                      <td>
                        <input id="modDestAcct" class="form-control" name="modDestAcct" placeholder="Enter New Account to credited">
                      </td>
                    </tr>

                    <!-- HIDDEN SELECTED KEYS -->
                    <tr style="display:none;">
                      <td colspan="2">
                        <input type="text" name="reference" value="${references}" hidden/>
                        <input type="text" name="accounts" value="${accounts}" hidden/>
                        ${hiddenData}
                      </td>
                    </tr>

                    <!-- SUBMIT -->
                    <tr id="rowSubmit">
                      <td colspan="2">
                        <button type="button" class="btn btn-primary btn-bulkAmbiguous" id="postReplayBtn" onclick="processReplayToRTGSIncomingToProxyAccounts()">Post</button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
            </div>`;

                    document.querySelector('#content').insertAdjacentHTML('afterbegin', formHtml);

                    // Bind events
                    $(document).off('change', '#replayOption').on('change', '#replayOption', function () {
                        toggleStawiUI(this.value);
                    });
                    $(document).off('click', '#verifyCdsBtn').on('click', '#verifyCdsBtn', function () {
                        verifyStawiAccount();
                    });

                    // Initialize to current selection
                    toggleStawiUI($('#replayOption').val());
                }
            });
        }

        /*
         * COMMIT REPLAY TO CORE BANKING ....
         */
        function toggleStawiUI(value) {
            var isStawi = (value === '10');

            if (isStawi) {
                // Only show reason + cds; hide everything else
                $('#rowReplayTo').hide();      // hide selector after choosing 10
                $('#rowBranchCode').hide();
                $('#rowModDest').hide();

                $('#rowReason').show();
                $('#rowCds').show();

                // Disable Post until verify success
                $('#postReplayBtn').prop('disabled', true);
                $('#lookupResult').empty();
            } else {
                // Normal flow
                $('#rowReplayTo').show();
                $('#rowBranchCode').show();
                $('#rowModDest').show();

                $('#rowReason').show();
                $('#rowCds').hide();

                $('#postReplayBtn').prop('disabled', false);
                $('#lookupResult').empty();
            }
        }

        // --- helpers ---
        function escapeHtml(s) { return $('<div/>').text(s || '').html(); }

        function parseJsonSafe(str) { try { return JSON.parse(str); } catch (_) { return null; } }

        // Map backend response codes to friendly messages (extend as needed)
        const STAWI_CODE_HELP = {
            '00': 'Verification successful.',
            '53': 'Account number is missing or empty.',
            '96': 'Invalid request. Please check the details and try again.',
            '0404': 'We could not find the referenced transfer.',
            '99': 'A system error occurred. Please try again.'
        };

        function friendlyMessageFromPayload(payload, fallback) {
            if (!payload) return fallback || 'Something went wrong.';
            // Prefer server-sent message if it’s useful; otherwise map the code
            const code = (payload.responseCode || '').toString();
            const msg = payload.message || STAWI_CODE_HELP[code];
            if (msg) return msg;
            // Fallback to status if present
            const status = payload.status ? String(payload.status).toUpperCase() : '';
            if (status && status !== 'SUCCESS') return 'Verification failed.';
            return fallback || 'Something went wrong.';
        }

        // --- main function ---
        function verifyStawiAccount() {
            var cds = ($('#cdsNumber').val() || '').trim();
            if (!cds) {
                $('#lookupResult').html('<div class="alert alert-warning">Please enter a CDS Number first.</div>');
                return;
            }

            // 1) Try to get the reference from the checked checkbox on the table
            var $cb = $('#inwardRTGSBankSuccessSummary input[type=checkbox]:checked').first();
            var trxRef = $cb.length ? (($cb.attr('id') || '').split('==')[0] || '') : '';

            // 2) Fallback: hidden inputs inside replayRTGSTransactionForm (name="txnid")
            if (!trxRef) {
                var $form = $('#replayRTGSTransactionForm');
                if ($form.length) trxRef = ($form.find('input[name="txnid"]').first().val() || '').trim();
            }

            if (!trxRef) {
                $('#lookupResult').html('<div class="alert alert-warning">Select a transaction first so we can include its reference.</div>');
                return;
            }

            $('#verifyCdsBtn').prop('disabled', true).text('Verifying…');
            $('#lookupResult').empty();

            var token  = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");

            $.ajax({
                url: '/fire/stawi/lookup',
                type: 'POST',
                contentType: 'application/json',
                dataType: 'json',
                data: JSON.stringify({ dseAccount: cds, transactionReference: trxRef }),
                beforeSend: function (xhr) {
                    if (token && header) xhr.setRequestHeader(header, token);
                },
                success: function (res, textStatus, xhr) {
                    var status = (res && res.status ? String(res.status) : '').toUpperCase();
                    var codeOk = (res && res.responseCode && String(res.responseCode).toUpperCase() === '00');

                    if (xhr.status === 200 && (status === 'SUCCESS' || codeOk)) {
                        var r = res.response || {};
                        var name  = r.investorName || 'N/A';
                        var phone = r.investorPhoneNumber || 'N/A';
                        var email = r.email || 'N/A';
                        var csd   = r.csdAccount || cds;

                        $('#lookupResult').html(
                            '<div class="alert alert-success">' +
                            '<strong>Verified.</strong> ' +
                            'Investor: ' + escapeHtml(name) +
                            ' | Phone: ' + escapeHtml(phone) +
                            ' | Email: ' + escapeHtml(email) +
                            ' | CSD: ' + escapeHtml(csd) +
                            ' | Ref: ' + escapeHtml(trxRef) +
                            '</div>'
                        );

                        $('#postReplayBtn').prop('disabled', false);
                        window._stawiLookup = res;
                        window._stawiLookupRef = trxRef;
                    } else {
                        var friendly = friendlyMessageFromPayload(res, 'Verification failed.');
                        $('#lookupResult').html(
                            '<div class="alert alert-danger"><strong>Verification failed:</strong> ' +
                            escapeHtml(friendly) + '</div>'
                        );
                        $('#postReplayBtn').prop('disabled', true);
                    }
                },
                error: function (xhr) {
                    // Try responseJSON first, then parse responseText if JSON string, else generic
                    var payload = xhr.responseJSON || parseJsonSafe(xhr.responseText);
                    var friendly = friendlyMessageFromPayload(payload, 'We could not verify the CDS number.');
                    // Optionally append small hint for users (not dev noise)
                    var hint = '';
                    var code = payload && payload.responseCode ? String(payload.responseCode) : '';
                    if (code && STAWI_CODE_HELP[code]) {
                        hint = ' (Code ' + code + ')';
                    }
                    $('#lookupResult').html(
                        '<div class="alert alert-danger"><strong>Verification failed:</strong> ' +
                        escapeHtml(friendly + hint) + '</div>'
                    );
                    $('#postReplayBtn').prop('disabled', true);
                },
                complete: function () {
                    $('#verifyCdsBtn').prop('disabled', false).text('Verify');
                }
            });
        }


        function processReplayToRTGSIncomingToProxyAccounts() {
            var formdata = new FormData($('#replayRTGSTransactionForm')[0]);
            console.log('RETURN REASONS: ' + formdata);
            var isStawi = ($('#replayOption').val() === '10');
            if (isStawi) {
                var cds = ($('#cdsNumber').val() || '').trim();
                var reason = ($('#reason').val() || '').trim();
                var bond = (function() {
                    // choose what you consider "bondNumber":
                    // here, we use the first selected transaction reference from hidden field(s)
                    var $cb = $('#inwardRTGSBankSuccessSummary input[type=checkbox]:checked').first();
                    return $cb.length ? (($cb.attr('id') || '').split('==')[0] || '') : '';
                })();

                if (!cds || !bond || !reason) {
                    $('#successFlag').html('<div class="alert alert-danger">CDS,Reason Bond Number are required.</div>');
                    return;
                }

                var token  = $("meta[name='_csrf']").attr("content");
                var header = $("meta[name='_csrf_header']").attr("content");

                $.ajax({
                    url: '/fire/stawi/notify',
                    type: 'POST',
                    contentType: 'application/json',
                    dataType: 'json',
                    data: JSON.stringify({dseAccount: cds, transactionReference: bond, reason: reason }),
                    beforeSend: function (xhr) { if (token && header) xhr.setRequestHeader(header, token); },
                    success: function (res) {
                        if (res.status === 'SUCCESS') {
                            $('#successFlag').html('<div class="alert alert-success"><strong>' + res.message + '</strong></div>');
                            // optionally reload your tables here
                        } else {
                            $('#successFlag').html('<div class="alert alert-danger"><strong>' + (res.message || 'Failed') + '</strong></div>');
                        }
                    },
                    error: function (xhr) {
                        $('#successFlag').html('<div class="alert alert-danger"><strong>Notification error:</strong> ' +
                            (xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Unknown error') + '</div>');
                    }
                });
                return; // stop normal flow
            }
            $.ajax({
                url: "/replayRTGSTxnsToCoreBanking",
                type: 'POST',
                data: formdata, //{senderAccount: senderAccount, senderName: senderName, senderAddress: senderAddress, amount: amount, currency: currency, beneficiaryName: beneficiaryName, beneficiaryBIC: beneficiaryBIC, description: description, supporting_doc: supporting_doc, beneficiaryAccount: beneficiaryAccount},
                enctype: 'multipart/form-data',
                processData: false,
                contentType: false,
                success: function (response) {
                    $('#inwardEFTBankSuccessSummary').DataTable().ajax.reload();//reload exception transaction report
                    $('#inwardRTGSSummary').DataTable().ajax.reload();/*reload summary report */
                    if (response.result == 0) {
                        $("#successFlag").html('<div class="alert alert-success" role="alert" id="successFlag"><button type="button" class="close" data-dismiss="alert"asuccessFlagria-label="Close"> </button><strong>' + response.message + '</strong></div>').show();
                    } else {
                        $("#successFlag").html('<div class="alert alert-danger" role="alert" id="successFlag"><button type="button" class="close" data-dismiss="alert"asuccessFlagria-label="Close"> </button><strong>' + response.message + response.result + '</strong></div>').show();
                    }
                },
                error: function (response) {
                    if (response.result == 0) {
                        $("#successFlag").html('<div class="alert alert-success" role="alert" id="successFlag"><button type="button" class="close" data-dismiss="alert"asuccessFlagria-label="Close"> </button><strong>' + response.message + '</strong></div>').show();
                    } else {
                        $("#successFlag").html('<div class="alert alert-danger" role="alert" id="successFlag"><button type="button" class="close" data-dismiss="alert"asuccessFlagria-label="Close"> </button><strong>' + response.message + response.result + '</strong></div>').show();
                    }
                }
            });
        }
    </script>
</div>
