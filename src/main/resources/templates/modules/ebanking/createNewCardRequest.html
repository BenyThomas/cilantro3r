<div layout:fragment="pageStyle" th:remove="tag">
    <style>
        #loading {
            background: url('/assets/images/ajax-loader.gif') no-repeat center center;
            position: absolute;
            top: 0;
            left: 0;
            height: 92%;
            width: 100%;
            z-index: 9999999;
        }
    </style>
    <link rel="stylesheet" th:href="@{/assets/plugins/datatables/jquery.dataTables.min.css}" type="text/css"/>
    <link rel="stylesheet" th:href="@{/assets/plugins/datatables/buttons.bootstrap.min.css}" type="text/css"/>
    <link rel="stylesheet" th:href="@{/assets/plugins/datatables/responsive.bootstrap.min.css}" type="text/css"/>
    <link rel="stylesheet" th:href="@{/assets/plugins/datatables/scroller.bootstrap.min.css}" type="text/css"/>
    <link rel="stylesheet" th:href="@{/assets/plugins/datatables/dataTables.colVis.css}" type="text/css"/>
    <link rel="stylesheet" th:href="@{/assets/plugins/datatables/dataTables.bootstrap.min.css}" type="text/css"/>
    <link rel="stylesheet" th:href="@{/assets/plugins/datatables/fixedColumns.dataTables.min.css}" type="text/css"/>
    <link rel="stylesheet" th:href="@{/assets/plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css}">
    <link rel="stylesheet" th:href="@{/assets/plugins/select2/css/select2.min.css}" type="text/css"/>
</div>
<div id="loading"></div>

<div class="row">
    <div class="panel panel-default panel-fill" id="tabContentsss">
        <div class="panel-heading"><h4 class="panel-title" th:text="${pageTitle}"></h4> <a class="btn btn-primary pull-right" id="addNewClient" style="background-color: #750a0a !important; border: 1px solid #b1e501 !important;margin-top: -22px !important;">New Card </a></div>
        <div class="panel-body">
            <!--client registration form start-->
            <div class="col-md-12" id="successFlag"></div>
            <div class="row" id="newClientForm" style="display: none;">
                <form id="createCardRequest">
                    <div class="col-md-12 alert alert-info" style="font-size:18px;  font-weight: bold;">
                        The email field is mandatory (Requeired by the system). Do not forget to fill it.
                    </div>
                    <div class="row" id="senderAccountError" style="display:none; margin-top:10% | important;">
                        <div class="form-group col-md-12">
                        <h5 class="alert alert-danger" style="font-size: 10px !important;"> Error: Please Try Again. Please contact IT Helpdesk / Database Administrator: RUBIKON NOT FOUND</h5>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-3">
                            <label for="senderAccount" style="margin-left: 1% ! important;">Account Number<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="senderAccount" name="accountNo" placeholder="Customer Account" type="text">
                        </div>
                        <div class="form-group col-md-3" style="margin-top:10% | important;">
                            <a class="btn btn-primary btn-submit pull-left" onclick="getCustomerDetails()" style="margin: 10%;font-size: 10px !important;" type="button">Query Details</a>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-3">
                            <label for="customerName" style="margin-left: 1% ! important;">Customer Name<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="customerName" name="customerName" placeholder="Customer Name" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="customerId" style="margin-left: 1% ! important;">Customer Id<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="customerId" name="customerId" placeholder="Customer Id" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="customerRim" style="margin-left: 1% ! important;">Customer Rim<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="customerRim" name="customerRim" placeholder="Customer RIM" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-3">
                            <label for="custShortName" style="margin-left: 1% ! important;">Customer shortName<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="custShortName" name="custShortName" placeholder="Customer ShortName" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="address1" style="margin-left: 1% ! important;">Customer Category<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="custCategory" name="custCategory" placeholder="customer Category" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="address1" style="margin-left: 1% ! important;">Address 1<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="address1" name="address1" placeholder="Address 1" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="address2" style="margin-left: 1% ! important;">Address 2<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="address2" name="address2" placeholder="Address 2" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-3">
                            <label for="address3" style="margin-left: 1% ! important;">Address 3<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="address3" name="address3" placeholder="Address 3" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="address4" style="margin-left: 1% ! important;">Address 4<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="address4" name="address4" placeholder="Address 4" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="city" style="margin-left: 1% ! important;">City<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="city" name="city" placeholder="City" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="state" style="margin-left: 1% ! important;">State<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="state" name="state" placeholder="State" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="countryCode" style="margin-left: 1% ! important;">Country Code<i class="text-danger"></i></label>
                            <select id="countryCode" name="countryCode" class="form-control form-control-sm" style="font-size: 10px !important;">
                                <option value="+255" selected>Tanzania (+255)</option>
                                <option value="+93">Afghanistan (+93)</option>
                                <option value="+355">Albania (+355)</option>
                                <option value="+213">Algeria (+213)</option>
                                <option value="+376">Andorra (+376)</option>
                                <option value="+244">Angola (+244)</option>
                                <option value="+1-268">Antigua and Barbuda (+1-268)</option>
                                <option value="+54">Argentina (+54)</option>
                                <option value="+374">Armenia (+374)</option>
                                <option value="+61">Australia (+61)</option>
                                <option value="+43">Austria (+43)</option>
                                <option value="+994">Azerbaijan (+994)</option>
                                <option value="+1-242">Bahamas (+1-242)</option>
                                <option value="+973">Bahrain (+973)</option>
                                <option value="+880">Bangladesh (+880)</option>
                                <option value="+1-246">Barbados (+1-246)</option>
                                <option value="+375">Belarus (+375)</option>
                                <option value="+32">Belgium (+32)</option>
                                <option value="+501">Belize (+501)</option>
                                <option value="+229">Benin (+229)</option>
                                <option value="+975">Bhutan (+975)</option>
                                <option value="+591">Bolivia (+591)</option>
                                <option value="+387">Bosnia and Herzegovina (+387)</option>
                                <option value="+267">Botswana (+267)</option>
                                <option value="+55">Brazil (+55)</option>
                                <option value="+673">Brunei (+673)</option>
                                <option value="+359">Bulgaria (+359)</option>
                                <option value="+226">Burkina Faso (+226)</option>
                                <option value="+257">Burundi (+257)</option>
                                <option value="+855">Cambodia (+855)</option>
                                <option value="+237">Cameroon (+237)</option>
                                <option value="+1">Canada (+1)</option>
                                <option value="+238">Cape Verde (+238)</option>
                                <option value="+236">Central African Republic (+236)</option>
                                <option value="+235">Chad (+235)</option>
                                <option value="+56">Chile (+56)</option>
                                <option value="+86">China (+86)</option>
                                <option value="+57">Colombia (+57)</option>
                                <option value="+269">Comoros (+269)</option>
                                <option value="+243">Congo (DRC) (+243)</option>
                                <option value="+242">Congo (Republic) (+242)</option>
                                <option value="+506">Costa Rica (+506)</option>
                                <option value="+385">Croatia (+385)</option>
                                <option value="+53">Cuba (+53)</option>
                                <option value="+357">Cyprus (+357)</option>
                                <option value="+420">Czech Republic (+420)</option>
                                <option value="+45">Denmark (+45)</option>
                                <option value="+253">Djibouti (+253)</option>
                                <option value="+1-767">Dominica (+1-767)</option>
                                <option value="+1-809">Dominican Republic (+1-809)</option>
                                <option value="+593">Ecuador (+593)</option>
                                <option value="+20">Egypt (+20)</option>
                                <option value="+503">El Salvador (+503)</option>
                                <option value="+240">Equatorial Guinea (+240)</option>
                                <option value="+291">Eritrea (+291)</option>
                                <option value="+372">Estonia (+372)</option>
                                <option value="+251">Ethiopia (+251)</option>
                                <option value="+679">Fiji (+679)</option>
                                <option value="+358">Finland (+358)</option>
                                <option value="+33">France (+33)</option>
                                <option value="+241">Gabon (+241)</option>
                                <option value="+220">Gambia (+220)</option>
                                <option value="+995">Georgia (+995)</option>
                                <option value="+49">Germany (+49)</option>
                                <option value="+233">Ghana (+233)</option>
                                <option value="+30">Greece (+30)</option>
                                <option value="+502">Guatemala (+502)</option>
                                <option value="+224">Guinea (+224)</option>
                                <option value="+245">Guinea-Bissau (+245)</option>
                                <option value="+592">Guyana (+592)</option>
                                <option value="+509">Haiti (+509)</option>
                                <option value="+504">Honduras (+504)</option>
                                <option value="+852">Hong Kong (+852)</option>
                                <option value="+36">Hungary (+36)</option>
                                <option value="+91">India (+91)</option>
                                <option value="+62">Indonesia (+62)</option>
                                <option value="+98">Iran (+98)</option>
                                <option value="+964">Iraq (+964)</option>
                                <option value="+353">Ireland (+353)</option>
                                <option value="+972">Israel (+972)</option>
                                <option value="+39">Italy (+39)</option>
                                <option value="+1-876">Jamaica (+1-876)</option>
                                <option value="+81">Japan (+81)</option>
                                <option value="+962">Jordan (+962)</option>
                                <option value="+7">Kazakhstan (+7)</option>
                                <option value="+254">Kenya (+254)</option>
                                <option value="+965">Kuwait (+965)</option>
                                <option value="+996">Kyrgyzstan (+996)</option>
                                <option value="+856">Laos (+856)</option>
                                <option value="+371">Latvia (+371)</option>
                                <option value="+961">Lebanon (+961)</option>
                                <option value="+266">Lesotho (+266)</option>
                                <option value="+231">Liberia (+231)</option>
                                <option value="+218">Libya (+218)</option>
                                <option value="+370">Lithuania (+370)</option>
                                <option value="+352">Luxembourg (+352)</option>
                                <option value="+261">Madagascar (+261)</option>
                                <option value="+265">Malawi (+265)</option>
                                <option value="+60">Malaysia (+60)</option>
                                <option value="+960">Maldives (+960)</option>
                                <option value="+223">Mali (+223)</option>
                                <option value="+356">Malta (+356)</option>
                                <option value="+222">Mauritania (+222)</option>
                                <option value="+230">Mauritius (+230)</option>
                                <option value="+52">Mexico (+52)</option>
                                <option value="+373">Moldova (+373)</option>
                                <option value="+377">Monaco (+377)</option>
                                <option value="+976">Mongolia (+976)</option>
                                <option value="+212">Morocco (+212)</option>
                                <option value="+258">Mozambique (+258)</option>
                                <option value="+95">Myanmar (+95)</option>
                                <option value="+264">Namibia (+264)</option>
                                <option value="+977">Nepal (+977)</option>
                                <option value="+31">Netherlands (+31)</option>
                                <option value="+64">New Zealand (+64)</option>
                                <option value="+505">Nicaragua (+505)</option>
                                <option value="+227">Niger (+227)</option>
                                <option value="+234">Nigeria (+234)</option>
                                <option value="+47">Norway (+47)</option>
                                <option value="+968">Oman (+968)</option>
                                <option value="+92">Pakistan (+92)</option>
                                <option value="+970">Palestine (+970)</option>
                                <option value="+507">Panama (+507)</option>
                                <option value="+675">Papua New Guinea (+675)</option>
                                <option value="+595">Paraguay (+595)</option>
                                <option value="+51">Peru (+51)</option>
                                <option value="+63">Philippines (+63)</option>
                                <option value="+48">Poland (+48)</option>
                                <option value="+351">Portugal (+351)</option>
                                <option value="+974">Qatar (+974)</option>
                                <option value="+40">Romania (+40)</option>
                                <option value="+7">Russia (+7)</option>
                                <option value="+250">Rwanda (+250)</option>
                                <option value="+966">Saudi Arabia (+966)</option>
                                <option value="+221">Senegal (+221)</option>
                                <option value="+248">Seychelles (+248)</option>
                                <option value="+232">Sierra Leone (+232)</option>
                                <option value="+65">Singapore (+65)</option>
                                <option value="+421">Slovakia (+421)</option>
                                <option value="+386">Slovenia (+386)</option>
                                <option value="+27">South Africa (+27)</option>
                                <option value="+82">South Korea (+82)</option>
                                <option value="+34">Spain (+34)</option>
                                <option value="+94">Sri Lanka (+94)</option>
                                <option value="+249">Sudan (+249)</option>
                                <option value="+597">Suriname (+597)</option>
                                <option value="+268">Swaziland (+268)</option>
                                <option value="+46">Sweden (+46)</option>
                                <option value="+41">Switzerland (+41)</option>
                                <option value="+963">Syria (+963)</option>
                                <option value="+886">Taiwan (+886)</option>
                                <option value="+992">Tajikistan (+992)</option>
                                <option value="+66">Thailand (+66)</option>
                                <option value="+228">Togo (+228)</option>
                                <option value="+216">Tunisia (+216)</option>
                                <option value="+90">Turkey (+90)</option>
                                <option value="+256">Uganda (+256)</option>
                                <option value="+380">Ukraine (+380)</option>
                                <option value="+971">United Arab Emirates (+971)</option>
                                <option value="+44">United Kingdom (+44)</option>
                                <option value="+1">United States (+1)</option>
                                <option value="+598">Uruguay (+598)</option>
                                <option value="+998">Uzbekistan (+998)</option>
                                <option value="+58">Venezuela (+58)</option>
                                <option value="+84">Vietnam (+84)</option>
                                <option value="+967">Yemen (+967)</option>
                                <option value="+260">Zambia (+260)</option>
                                <option value="+263">Zimbabwe (+263)</option>
                            </select>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="phone" style="margin-left: 1% ! important;">Phone<i class="text-danger">*(Number should not start with 0 eg:- 71935420X)</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="phone" name="phoneNumber" placeholder="71935420X" style="font-size: 10px !important;" type="text">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-3">
                            <label for="branchId" style="margin-left: 1% ! important;">branch id<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="branchId" name="branchId" placeholder="Branch id" readonly="" style="font-size: 10px !important;" type="text">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="recruitingBrach" style="margin-left: 1% ! important;">Where To Pick Card?<i class="text-danger">*</i></label>
                            <select class="form-control col-sm-12 select2" id="recruitingBrach" name="recruitingBrach" style="font-size: 10px !important;">
                                <option th:value="${session.branchCode}" selected="selected">Our Branch</option>
                                <option th:each="branch: ${branches}" th:text="${branch.name}" th:value="${branch.code}">
                            </select>
                        </div>


                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-3">
                            <label for="cardType" style="margin-left: 1% ! important;">Select Card Type<i class="text-danger">*</i></label>
                            <select class="form-control col-sm-12 select2" id="cardType" name="cardType" style="font-size: 10px !important;">
                                <option  th:each="item: ${visaBins}" th:text="${item.getRefKey()}" th:value="${item.getRefDesc()}">
                            </select>
                        </div>
                        <div class="form-group col-md-3">
                            <label for="phone" style="margin-left: 1% ! important;">Filled Form<i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="cardForm" name="cardForm" placeholder="Supporting Document" style="font-size: 10px !important;" type="file">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="customerEmail" style="margin-left: 1% ! important;">Email <i class="text-danger">*</i></label>
                            <input autocomplete="off" class="form-control form-control-sm" id="customerEmail" name="customerEmail" placeholder="Email" style="font-size: 10px !important;" type="email">
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group col-md-3">
                            <div class="form-group col-md-3 text-right m-b-0" style="margin: 10%;">
                                <button class="btn btn-primary create-ib-client-profile" onclick="createNewCardRequest()"  type="button">Save Request</button>
                            </div>
                        </div>
                    </div>
                </form>

            </div>
            <!--client registration form ends-->
            <div class="row">
                <table class="display nowrap table table-striped table-bordered" id="profilesInitiated"
                       style="width: 100%; font-size: 7.5px !important;">
                    <thead>
                    <tr>
                        <th>Reference</th>
                        <th>Account</th>
                        <th>Phone</th>
                        <th>Name</th>
                        <th>Rim No</th>
                        <th>Short Name</th>
                        <th>Category</th>
                        <th>Address1</th>
                        <th>Address2</th>
                        <th>Address3</th>
                        <th>Address4</th>
                        <th>Created by</th>
                        <th>Create Date</th>
                        <th>Status</th>
                        <th style="width: 512px !important;">ACTION</th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
                <!--</form>-->
            </div>
        </div>
    </div>
</div>
<!--<div class="form-group col-md-9">-->

<div class="row">
</div>
<div layout:fragment="pageScript" th:remove="tag">
    <script th:src="@{/assets/plugins/datatables/jquery.dataTables.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.bootstrap.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.buttons.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/buttons.bootstrap.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/jszip.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/pdfmake.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/vfs_fonts.js}"></script>
    <script th:src="@{/assets/plugins/datatables/buttons.html5.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/buttons.print.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.keyTable.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.responsive.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/responsive.bootstrap.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.scroller.min.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.colVis.js}"></script>
    <script th:src="@{/assets/plugins/datatables/dataTables.fixedColumns.min.js}"></script>

    <!--init-->
    <script th:src="@{/assets/pages/jquery.datatables.init.js}"></script>
    <!--App Js-->
    <script th:src="@{/assets/js/jquery.app.js}"></script>
    <script th:src="@{/assets/plugins/select2v4/select2.min.js}"></script>
    <script th:src="@{/assets/plugins/select2/js/select2.min.js}" type="text/javascript"></script>
    <script th:src="@{/assets/scripts/ebanking.js}"></script>
    <script type="text/javascript" th:inline="javascript">
        let loggedInUser = /*[[${loggedInUser}]]*/;
        $(document).ready(function () {
            //ADD NEW CLIENT TOGGLE MENU
            $('#addNewClient').click(function () {
                $('#newClientForm').toggle('slide');
            });
            $('.select2').select2({
            theme:'classic',
            height:'80%',
            width:'100%'
            });
            $("#loading").hide();
//            rtgsTransferForm

//add the number of files to be attached
            var max_fields = 4;
            var wrapper = $("#supportingDocument");
            var add_button = $("#addField");

            var x = 1;
            $(add_button).click(function (e) {
                e.preventDefault();
                if (x < max_fields) {
                    x++;
                    $(wrapper).append('<input type="file" name="supportingDoc" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Supporting Document">'); //add input box
                } else {
                    alert('You Reached the limits');
                }
            });

            $(wrapper).on("click", ".delete", function (e) {
                e.preventDefault();
                $(this).parent('div').remove();
                x--;
            });
            //ON SELECTING DESTINATION BANK CHECK IF ITS INTERNATIONAL AND ADD AN INPUT FIELD FOR INTERMEDIARY BANK
            $('#intermediary').html("");
            $("#destinationBank").on('change', function () {
                var benBic = $("select[name='beneficiaryBIC']").val();
                var identifier = benBic.split('==');
                if (identifier[1] === 'INTERNATIONAL') {
                    /*
                     * ADD AN INPUT FOR INTERMEDIARY SWIFT CODE
                     */
                    $('#intermediary').append('<input type="text" id="intermediaryBank" name="intermediaryBank" autocomplete="off" class="form-control form-control-sm" style="font-size: 10px !important;" placeholder="Intermediary Bank Swift Code (IF APPLICABLE)">');

                }
            });
            $("#mno").on('change', function () {
                $('#profilesInitiated').DataTable().ajax.reload();
            });
            var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");
            var b = 1;
            var i = 0;
            var table = $('#profilesInitiated').DataTable({
                dom: 'Blfrtip',
                lengthChange: true,
                scrollCollapse: true,
                scrollY: "700px",
                scrollX: true,
                pageLength: 10,
                lengthMenu: [
                    [5, 10, 25, 50, 100, 500, -1],
                    [5, 10, 25, 50, 100, 500, 'Show all']
                ],
                responsive: false,
                processing: true,
                serverSide: true,
                serverMethod: 'post',
                order: [1, "desc"],
                ajax: {
                    'url': '/getCardsRequestsPendingAtBranch',
                    'beforeSend': function (request) {
                        request.setRequestHeader(header, token);
                    }
//                    "data": function (d) {
//                        return $.extend({}, d, {
//                            "mno": $("select[name='mno']").val()
//                        });
//                    }
                },
                "columns": [
                    {"data": "reference"},
                    {"data": "account_no"},
                    {"data": "phone"},
                    {"data": "customer_name"},
                    {"data": "customer_rim_no"},
                    {"data": "customer_shortName"},
                    {"data": "customer_category"},
                    {"data": "address1"},
                    {"data": 'address2'},
                    {"data": "address3"},
                    {"data": 'address4'},
                    {
                        "data": "created_by",

                    },
                    {
                        "data": 'create_dt',
                        "render": function (data, type, row) {
                            return formatDateTime(data)
                        }
                    },
                    {"data": 'status',
                        "render": function (data, type, row, meta) {
                            var a = '';
                            if (row.status === "I") {
                                a = "INITIATED"
                            }
                            if (row.status === "P") {
                                a = "PENDING"
                            }
                            if (row.status === "C") {
                                a = "COMPLETED"
                            }
                            if(row.status === "RA"){
                               a = "RETURNED FOR AMENDMENT"
                            }
                            return a;
                        }},

                    {"data": 'reference',
                        "orderable": false,
                        "searchable": false,
                        "render": function (data, type, row, meta) {
                            var a = '';
                            if(row.created_by !== loggedInUser){
                               a = '<button style="background-color: green !important; border-color: #6a7308; color: white !important; font-size: 11px !important;"  type="button" onclick="previewCardRequest(\'' + row.reference + '\')"> Approve </button>';
                            }
                            return a;
                        }}
                ], aoColumnDefs: [
                    {
                        bSortable: false,
                        aTargets: [-1],
                    }
                ], columnDefs: [
                    {width: 1000, targets: 14}
                ],
//                fixedColumns: true,
                buttons: [{
                        extend: "copy",
                        title: 'Authorize RTGS Remittance Transactions',
                        className: "btn-sm"
                    }, {
                        extend: "csv",
                        title: 'Authorize RTGS Remittance  Transactions',
                        className: "btn-sm"
                    }, {
                        extend: "excel",
                        title: 'Authorize RTGS Remittance  Transactions',
                        className: "btn-sm"
                    }, {
                        extend: "pdf",
                        title: 'Authorize RTGS Remittance  Transactions',
                        className: "btn-sm"
                    }, {
                        extend: "print",
                        title: 'Authorize RTGS Remittance  Transactions',
                        className: "btn-sm"
                    }],
                "preDrawCallback": function (settings) {
                    if ($("select[name='mno']").val() == '') {
                        return false;
                    }
                }
            });

        });
        function getCustomerDetails() {
            console.log("sender account pressed!!!");
            $("#loading").show();
            var accountNo = $("input[name='accountNo']").val();
            $('#senderAccountError').hide();
            $.ajax({
                url: "/queryCustomerDetails",
                type: 'GET',
                data: {accountNo: accountNo, code: "searchAccount"},
                dataType: "json",
                success: function (res) {
                    $("#loading").hide();
                    $('#senderAccountError').hide();
                    $("#actNM").val(res[0].CUST_NM);
                    $("#availableBalance").text('Available Blance: ' + addCommas(res[0].CLEARED_BAL));
                    $("#customerName").val(res[0].FIRST_NM + ' ' + res[0].LAST_NM);
                    $("#customerId").val(res[0].CUST_ID);
                    $("#customerRim").val(res[0].CUST_NO);
                    $("#custShortName").val(res[0].CUST_SHORT_NM);
                    $("#custCategory").val(res[0].CUST_CAT);
                    $("#address1").val(res[0].ADDR_LINE_1);
                    $("#address2").val(res[0].ADDR_LINE_2);
                    $("#address3").val(res[0].ADDR_LINE_3);
                    $("#address4").val(res[0].ADDR_LINE_4);
                    $("#city").val(res[0].CITY);
//                    $("#email").val("not set");
                    $("#branchId").val(res[0].BU_NO);
                    $("#branchCode").val(res[0].MAIN_BRANCH_ID);
                    $("#state").val(res[0].STATE);
                    console.log(res)
                },
                error: function (res) {
                    $("#loading").hide();
                    $('#senderAccountError').show();
                    console.log(res);
                }
            })
        }



        function formatDateTime(dateString) {
            if (!dateString) return ''; // Handle null or empty values
            var date = new Date(dateString);
            var year = date.getFullYear();
            var month = ('0' + (date.getMonth() + 1)).slice(-2);
            var day = ('0' + date.getDate()).slice(-2);
            var hours = ('0' + date.getHours()).slice(-2);
            var minutes = ('0' + date.getMinutes()).slice(-2);
            var seconds = ('0' + date.getSeconds()).slice(-2);

            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }


        function addCommas(nStr) {
            nStr += '';
            x = nStr.split('.');
            x1 = x[0];
            x2 = x.length > 1 ? '.' + x[1] : '';
            var rgx = /(\d+)(\d{3})/;
            while (rgx.test(x1)) {
                x1 = x1.replace(rgx, '$1' + ',' + '$2');
            }
            return x1 + x2;
        }
    </script>
</div>
